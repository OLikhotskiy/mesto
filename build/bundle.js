(()=>{"use strict";class e{static selectors={pic:".element__picture",title:".element__title",like:".element__like",likeActive:"element__like_active",trash:".element__trash",element:".element",caption:".popup__image-caption",big:".popup__big-pic"};constructor(e,t,s,i){this._name=e,this._link=t,this._templateSelector=s,this._handleCardClick=i}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(e.selectors.element).cloneNode(!0)}generateCard(){return this._card=this._getTemplate(),this._cardPic=this._card.querySelector(e.selectors.pic),this._cardLike=this._card.querySelector(e.selectors.like),this._cardTitle=this._card.querySelector(e.selectors.title),this._cardTrash=this._card.querySelector(e.selectors.trash),this._cardPic.src=this._link,this._cardPic.alt=this._name,this._cardTitle.textContent=this._name,this._hangEventListeners(),this._card}_likeCard(){this._cardLike.classList.toggle(e.selectors.likeActive)}_deleteCard(){this._card.remove()}_hangEventListeners(){this._cardLike.addEventListener("click",(()=>{this._likeCard()})),this._cardTrash.addEventListener("click",(()=>{this._deleteCard()})),this._cardPic.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}}const t={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};class s{constructor(e,t){this._inputSelector=e.inputSelector,this._buttonSubmit=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submit=this._form.querySelector(this._buttonSubmit)}_checkInputValidity=e=>{const t=this._form.querySelector(`#${e.id}-error`);e.validity.valid?this._hideError(e,t):this._showError(e,t)};_hideError(e,t){t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_showError(e,t){t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}toggleSubmitButtonState=()=>{this._inputList.every((e=>e.validity.valid))?(this._submit.classList.remove(this._inactiveButtonClass),this._submit.disabled=!1):(this._submit.classList.add(this._inactiveButtonClass),this._submit.disabled=!0)};_hangEventListener=()=>{this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleSubmitButtonState()}))}))};enableValidation=()=>{this._hangEventListener()};resetValidation=()=>{this._inputList.forEach((e=>{const t=this._form.querySelector(`#${e.id}-error`);this._hideError(e,t)})),this.toggleSubmitButtonState()}}class i{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_is-open"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popup.classList.remove("popup_is-open"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("click",(e=>{e.target.closest(".popup__overlay")&&!e.target.classList.contains("popup__close")||this.close()}))}}class r extends i{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=Array.from(this._form.querySelectorAll(".popup__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{this._handleSubmit(e,this._getInputValues())}))}close(){super.close(),this._form.reset()}}const n=document.querySelector(".profile__edit"),o=document.querySelector(".popup_type_profile-edit"),a=document.querySelector(".popup__input_type_name"),p=document.querySelector(".popup__input_type_about"),c=document.querySelector(".profile__add"),l=document.querySelector(".popup_type_add"),_=new class extends i{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__big-pic"),this._popupImageCaption=this._popup.querySelector(".popup__image-caption")}open(e,t){this._popupImageCaption.textContent=e,this._popupImage.alt=e,this._popupImage.src=t,super.open()}}(".popup_type_image"),u=new r(".popup_type_profile-edit",(function(e,t){e.preventDefault(),h.setUserInfo(t.name,t.about),u.close()})),d=new r(".popup_type_add",(function(e,t){e.preventDefault();const s={name:t.name,link:t.link},i=k(s);m.addItem(i),d.close()})),h=new class{constructor({name:e,about:t}){this._name=document.querySelector(e),this._about=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e,t){this._name.textContent=e,this._about.textContent=t}}({name:".profile__name",about:".profile__about"}),m=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems=()=>{this._items.forEach((e=>{this._renderer(e)}))};addItem=e=>{this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=k(e);m.addItem(t)}},".elements"),v=new s(t,o),y=new s(t,l),k=function(t){return new e(t.name,t.link,"#element-template",b).generateCard()};function b(e,t){_.open(e,t)}n.addEventListener("click",(()=>{v.resetValidation(),u.open();const{name:e,about:t}=h.getUserInfo();a.value=e,p.value=t})),c.addEventListener("click",(()=>{y.resetValidation(),d.open()})),_.setEventListeners(),u.setEventListeners(),d.setEventListeners(),m.renderItems(),v.enableValidation(),y.enableValidation()})();